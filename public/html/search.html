<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Search</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <div class="container mt-3">
      <h3 style="text-align: center; margin-top: 400px">Search infomation</h3>

      <div class="input-group mb-3">
        <input
          id="inputMac"
          type="text"
          class="form-control"
          placeholder="MacAddress"
        />
      </div>
      <button
        class="btn btn-success"
        type="button"
        style="width: 100px"
        onclick="Search()"
      >
        Search
      </button>

      <div id="divResult" style="font-size: 100px;"></div>
    </div>
    <script>
      async function Search() {
        document.getElementById("divResult").innerHTML = "";
        let mac = document.getElementById("inputMac").value;
        if(mac == undefined || mac == ''){
            document.getElementById("divResult").innerHTML = "";
        }
        var myHeaders = new Headers();
        myHeaders.append("accept", "application/json");
        myHeaders.append("Authorization", "Bearer " + localStorage.getItem("token"));
        // myHeaders.append(
        //   "Authorization",
        //   "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjdiNjBjMzlkLTBhZDktNDBhOC05NTBkLTk5YTI1ZTQ4Mzc2YiIsIm5hbWUiOiJsYW0ubmd1eWVuQHdlY2hlZXIuaW8iLCJlbWFpbCI6ImxhbS5uZ3V5ZW5Ad2VjaGVlci5pbyIsImlhdCI6MTY4Njg4MTQ1NCwiZXhwIjoxNjg2OTAzMDU0fQ.2SmkW9SkDOW1uUR6SE4CodeOp0SCmoH9bvMYRKEmS8w"
        // );

        var requestOptions = {
          method: "GET",
          headers: myHeaders,
          redirect: "follow",
        };
        fetch(
          "http://35.240.171.212:3000/automatic-results?fromDate=2023-01-01&toDate=2023-08-30&macAddress="+mac,
          requestOptions
        )
          .then((response) => response.text())
          .then((result) => {
            let array = JSON.parse(result);
            try {
                document.getElementById("divResult").innerHTML = "Loáº¡i: "+array[0].type;
            } catch (error) {
                document.getElementById("divResult").innerHTML = "-";
            }
          })
          .catch((error) => console.log("error", error));
      }
    </script>
  </body>
</html>
